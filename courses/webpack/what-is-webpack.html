<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <link rel="icon" href="/favicon.ico"><link rel="manifest" href="/manifest.webmanifest"><meta name="theme-color" content="#5397d2"><script>
      var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?e772d8d7735057378a672ae311e9bf20";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
    </script><title>什么是 Webpack | 众里千寻</title><meta name="description" content="介绍 Webpack 的基本概念"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.22">
    <link rel="preload" href="/assets/js/runtime~app.fa50ff6a.js" as="script"><link rel="preload" href="/assets/css/styles.e0095a00.css" as="style"><link rel="preload" href="/assets/js/3767.b5b9e7ce.js" as="script"><link rel="preload" href="/assets/js/app.8de2a662.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.e0095a00.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/" class=""><img class="logo" src="/hero-c.png" alt="众里千寻"><span class="site-name can-hide">众里千寻</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/courses/" class="nav-link router-link-active" aria-label="学习笔记"><!--[--><!--]--> 学习笔记 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/solutions/" class="nav-link" aria-label="解决方案"><!--[--><!--]--> 解决方案 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/tools/" class="nav-link" aria-label="开发利器"><!--[--><!--]--> 开发利器 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/code-reading/" class="nav-link" aria-label="源码解读"><!--[--><!--]--> 源码解读 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/posts/" class="nav-link" aria-label="最新消息"><!--[--><!--]--> 最新消息 <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/everfind" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/courses/" class="nav-link router-link-active" aria-label="学习笔记"><!--[--><!--]--> 学习笔记 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/solutions/" class="nav-link" aria-label="解决方案"><!--[--><!--]--> 解决方案 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/tools/" class="nav-link" aria-label="开发利器"><!--[--><!--]--> 开发利器 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/code-reading/" class="nav-link" aria-label="源码解读"><!--[--><!--]--> 源码解读 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/posts/" class="nav-link" aria-label="最新消息"><!--[--><!--]--> 最新消息 <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/everfind" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">什么是 Webpack</p><ul class=""><li><!--[--><a aria-current="page" href="/courses/webpack/what-is-webpack.html#概述" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="概述"><!--[--><!--]--> 概述 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/courses/webpack/what-is-webpack.html#webpack-的执行过程-execution-process" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Webpack 的执行过程（execution process）"><!--[--><!--]--> Webpack 的执行过程（execution process） <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/courses/webpack/what-is-webpack.html#webpack-的解析过程-resolution-process" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Webpack 的解析过程（resolution process）"><!--[--><!--]--> Webpack 的解析过程（resolution process） <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/courses/webpack/what-is-webpack.html#webpack-的评估过程-evaluation-process" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Webpack 的评估过程（Evaluation process）"><!--[--><!--]--> Webpack 的评估过程（Evaluation process） <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/courses/webpack/what-is-webpack.html#webpack-的输出" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Webpack 的输出"><!--[--><!--]--> Webpack 的输出 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/courses/webpack/what-is-webpack.html#webpack-是配置驱动的" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Webpack 是配置驱动的"><!--[--><!--]--> Webpack 是配置驱动的 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/courses/webpack/what-is-webpack.html#总结" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="总结"><!--[--><!--]--> 总结 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><p>Webpack 是一个模块打包器（module bundler），在 webpack 中模块（module）是最基本的概念。</p><h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述" aria-hidden="true">#</a> 概述</h2><p>举个例子方便说明，一个应用有如下目录结构：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>— src
  — app.js
  — file-a.js
  — file-b.js
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>应用的入口文件是 app.js, 内容如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> moduleA <span class="token keyword">from</span> <span class="token string">&#39;./file-a&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> moduleB <span class="token keyword">from</span> <span class="token string">&#39;./file-b&#39;</span><span class="token punctuation">;</span>

<span class="token comment">/*
 * 一些应用逻辑
 */</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>在这个项目中，我们有三个模块，分别是 <code>app.js</code>，<code>file-a.js</code> 和 <code>file-b.js</code>。 Webpack 在执行打包的时候，会从应用入口（<code>app.js</code>）开始解析，通过 <code>import</code> 语句解析到 <code>app.js</code> 依赖了 <code>file-a.js</code> 和 <code>file-b.js</code> 这两个模块，构成一个依赖图（dependency graph）。</p><blockquote><p>依赖图是一个描述各节点之间关系的有向图，在这里，这个图是由各个文件之间的 <code>import</code> 和 <code>require</code> 来定义的。Webpack 会单纯静态的扫描而不执行这些文件，来生成这个图。</p></blockquote><p>之后，webpack 会根据用户的配置生成输出文件（output）。此外，用户还可以在代码中定义分割点（split points），将应用的代码分割打包到不同的 bundle 中，实现按需加载。</p><blockquote><p>所谓 bundle，就是一组代码的集合，可以将一个应用的所有代码都打包到一个 bundle 中，也可以分成多个 bundle，按需加载。在 Webpack 中，还有一个常见的名词 chunk，chunk 就是代码块，多个 chunk 组成了 bundle。</p></blockquote><p>Webpack 默认支持 ES2015，CommonJS，MJS 和 AMD 模块规范。同时，通过 loader 机制，借助于 css-loader 提供的 <code>@import</code> 和 <code>url()</code> 语法，webpack 还可以支持对 css 文件的打包。</p><h2 id="webpack-的执行过程-execution-process" tabindex="-1"><a class="header-anchor" href="#webpack-的执行过程-execution-process" aria-hidden="true">#</a> Webpack 的执行过程（execution process）</h2><p><img src="/courses/webpack/webpack-c.png" alt="Webpack"></p><p>上图清晰地展示了 Webpack 的执行过程。</p><p>首先 Webpack 从 <code>entry</code> 文件开始处理，通常这些 <code>entiry</code> 文件是 JavaScript 文件。在执行过程中，webpack 会根据 loader 的配置来决定如何处理每一个匹配到的文件。最终，在生成依赖图以后，再输出打包后的文件。</p><h2 id="webpack-的解析过程-resolution-process" tabindex="-1"><a class="header-anchor" href="#webpack-的解析过程-resolution-process" aria-hidden="true">#</a> Webpack 的解析过程（resolution process）</h2><p>Webpack 通过 <code>resolve</code> 配置项来在文件系统中查找遇到的每一个模块，比如我们可以通过配置来让 webpack 避开 node_modules 目录。</p><p>如果解析失败，webpack 会抛出一个运行时错误，如果解析成功，webpack 则会根据 <code>loader</code> 的配置来处理这个文件。每个 <code>loader</code> 都定义了一套处理对应模块内容的方法。</p><p>可以通过多种方式给某一类型的文件指定 <code>loader</code>，比如文件类型或者文件在文件系统中的位置。Webpack 支持通过同样的方式来指定 <code>loader</code>，<code>loader</code> 本身就有自己的 <code>resolve</code> 配置。如果 webpack 查找 <code>loader</code> 失败，则会抛出一个运行时错误。</p><p>Webpack 会解析它碰到的任何一个模块，如果一个模块依赖了其他模块，那么 Webpack 会递归的解析每一个依赖模块，直到解析完所有的模块。</p><p>同时，Webpack 允许用户自定义不同资源的处理方式。比如用户可以选择将某些资源内联在 JavaScript 文件中来减少网络请求，可以通过 CSS Modules 等技术来将样式与组件关联起来，避免全局冲突。</p><p>尽管主要被用来打包 JavaScript，Webpack 还可以被用来处理图片、字体文件这样的资源文件，并将其单独输出文件。这一切都取决于用户如何配置。</p><h2 id="webpack-的评估过程-evaluation-process" tabindex="-1"><a class="header-anchor" href="#webpack-的评估过程-evaluation-process" aria-hidden="true">#</a> Webpack 的评估过程（Evaluation process）</h2><p>假设用户配置的所有 <code>loader</code> 都成功解析，Webpack 在处理模块的时候，会从下到上、从右到左（<code>styleLoader(cssLoader(&#39;./main.css&#39;))</code>）按序依次用匹配的 <code>loader</code> 来对模块进行处理。如果一个 <code>loader</code> 执行成功，没有任何运行时错误，那么 Webpack 就将模块的源代码包含到最终生成的 bundle 中。</p><p>尽管 <code>loader</code> 处理模块时功能非常强大，但是 <code>loader</code> 却不能处理一些更高级的任务。 Webpack 插件弥补了这一不足。插件可以截取 Webpack 的运行时事件（runtime events）来做一些额外的任务。</p><p>MiniCssExtractPlugin 就是一个很好的例子，在和 <code>loader</code> 配合使用的时候，MiniCssExtractPlugin 可以将 css 文件从 bundle 中抽取出来，放到独立的文件中去。否则 css 文件将会和 JavaScript 文件打包在一起。</p><h2 id="webpack-的输出" tabindex="-1"><a class="header-anchor" href="#webpack-的输出" aria-hidden="true">#</a> Webpack 的输出</h2><p>在处理完所有的模块以后，Webpack 开始输出文件。在输出文件中有一个非常小的运行时（runtime）文件，该运行时文件负责在浏览器中执行 Webpack 输出的结果。另外，在输出文件中还有一个 manifest 文件，记录了所有需要被加载的 bundle 。</p><h2 id="webpack-是配置驱动的" tabindex="-1"><a class="header-anchor" href="#webpack-是配置驱动的" aria-hidden="true">#</a> Webpack 是配置驱动的</h2><p>Webpack 是配置驱动的，下面的配置样例清楚的展示如何配置 Webpack 进行打包：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span> app<span class="token operator">:</span> <span class="token string">&#39;./entry.js&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 开始打包</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 输出到 dist 目录</span>
    filename<span class="token operator">:</span> <span class="token string">&#39;[name].js&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 输出 app.js ，因为 entry 的名称为 app</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 解析所有遇到的模块</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;style-loader&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;css-loader&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">&#39;swc-loader&#39;</span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 进行额外的处理</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token constant">HELLO</span><span class="token operator">:</span> <span class="token string">&#39;hello&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 调整模块解析方式</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      react<span class="token operator">:</span> <span class="token string">&#39;preact-compat&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>Webpack 的配置非常复杂，而且经常会慢慢变得难以理解。本系列的目的就是为了将这些背后的概念和设计讲清楚，方便更好的理解 Webpack .</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><p>Webpack 是一个模块打包器，通过遍历所有模块来生成依赖图，并基于依赖图和用户配置来输出打包结果。</p><p>Webpack 依赖于 <code>loader</code> 和 <code>plugin</code>。<code>loader</code> 负责处理模块，而 <code>plugin</code> 则借助于 Webpack 提供的钩子能更好的与执行过程配合执行一些其他处理任务。</p><p>Webpack 的配置文件描述了 Webpack 如何来处理各种资源文件，并决定最终以何种形式输出。</p><div style="display:flex;align-items:center;justify-content:center;"><p style="text-align:center;margin-top:10px;color:#999;"><img src="/qrcode-c.jpg" style="width:200px;height:200px;display:block;margin:10px auto;opacity:0.8;">关注微信公众号，获取最新推送~</p><p style="text-align:center;margin-top:10px;color:#999;"><img src="/card-c.jpeg" style="width:200px;height:200px;display:block;margin:10px auto;opacity:0.8;">加微信，深入交流~</p></div><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main></div><!----><!----><!--]--></div>
    <script src="/assets/js/runtime~app.fa50ff6a.js" defer></script><script src="/assets/js/3767.b5b9e7ce.js" defer></script><script src="/assets/js/app.8de2a662.js" defer></script>
  </body>
</html>
